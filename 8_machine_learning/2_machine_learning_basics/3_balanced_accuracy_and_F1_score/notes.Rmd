---
title: "Balanced Accuracy and the F1 Score"
subtitle: "Machine Learning - Section 2.1.3"
author: "_Marc Omar Haddad_"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
  html_notebook:
    theme: readable
    highlight: zenburn
  #pdf_document:
    #latex_engine: xelatex
    #df_print: kable
---
\

```{r dependencies, include=FALSE, results='hide'}
library(tidyverse)
library(caret)
library(dslabs)
data(heights)
set.seed(2, sample.kind = "Rounding")
options(digits = 3)
y = heights$sex # Categorical outcome (male or female)
x = heights$height
# Var containing index vals
test_index = createDataPartition(y, times = 1, p = 0.5, list = FALSE)
# The actual splitting of the dataset by rand. gen. index vals.
train_set = heights[-test_index, ]
test_set = heights[test_index, ]
cutoff = seq(61, 70) # Defining sequence of cutoffs
accuracy = map_dbl(cutoff, function(x) {
  y_hat = ifelse(train_set$height > x, "Male", "Female") %>% 
    factor(levels = levels(test_set$sex))
  mean(y_hat == train_set$sex)
})
best_cutoff = cutoff[which.max(accuracy)]
y_hat = ifelse(test_set$height > best_cutoff, "Male", "Female") %>%
  factor(levels = levels(test_set$sex))
prev = mean(y == "Male")
```


